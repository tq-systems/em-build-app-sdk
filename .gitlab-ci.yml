---
include:
- project: tq-em/build/docker/toolchain-ci
  file: common/include.yml
  ref: master
- local: ci/templates.yml

stages:
- build
- test
- deploy

# Builds
Build Documentaion:
  stage: build
  extends:
    - .artifacts-always-one-week
    - .gitlab-runner-linux
    - .image-doc
  script: make docs

Build All (staging):
  extends: .staging-build
  variables:
    MAKE_TARGET: "all"
    LOCAL_DEPLOYMENT_PATH: "/home/tqemci/workspace/deploy"
  script:
    - make ${MAKE_TARGET} TQEM_BASE_DEPLOY_PATH="${LOCAL_DEPLOYMENT_PATH}"

# Tests
Shell Linter:
  extends:
    - .lint-shell
    - .rule-include-development-branches

Python Linter:
  extends:
    - .lint-python
    - .rule-include-development-branches

Gitleaks:
  extends: .gitleaks
